   █████████  ██████████ ██████   ██████ █████ ██████   █████ █████
  ███░░░░░███░░███░░░░░█░░██████ ██████ ░░███ ░░██████ ░░███ ░░███
 ███     ░░░  ░███  █ ░  ░███░█████░███  ░███  ░███░███ ░███  ░███
░███          ░██████    ░███░░███ ░███  ░███  ░███░░███░███  ░███
░███    █████ ░███░░█    ░███ ░░░  ░███  ░███  ░███ ░░██████  ░███
░░███  ░░███  ░███ ░   █ ░███      ░███  ░███  ░███  ░░█████  ░███
 ░░█████████  ██████████ █████     █████ █████ █████  ░░█████ █████
  ░░░░░░░░░  ░░░░░░░░░░ ░░░░░     ░░░░░ ░░░░░ ░░░░░    ░░░░░ ░░░░░

# Gemini-CLI 개발 가이드: 이모지 스머글링 공격 분석 및 재현

## 1. 프로젝트 개요

- 목표: "이모지 스머글링(Emoji Smuggling)" 또는 "이모지 이베이젼(Emoji Evasion)" AI 프롬프트 인젝션 공격에 대해 탐구한다. 이 공격은 보이지 않는 유니코드 문자(예: Variation Selectors)를 이용하여 악의적인 프롬프트를 숨겨, 무해해 보이는 이모지 뒤에 덧붙이는 기법이다. 해당 AI 프롬프트 인젝션 공격 기법을 자세히 알아보고 시연하며, 대안 공격 방법 및 방어 방안을 제안하는 리포지토리를 구축한다. 
- 최종 결과물:
  1. `emoji_smuggler.py` (초기 기획): 원본 JS/TS PoC(Proof of Concept)를 포팅한, 주석이 상세히 달린 Python 스크립트.
  2. `README.md`: 이 공격이 작동하는 근본 원리를 전문가 수준에서 **한국어 및 영어**로 설명하는 메인 문서.
- 핵심 키워드: AI Security, Prompt Injection, Emoji Smuggling, Emoji Evasion, Unicode, UTF-8, LLM Vulnerability, Python

## 2. 프로젝트 구성

Gist 레포지토리는 다음 파일들로 구성된다.

- `README.md`: 프로젝트의 목적, "이모지 스머글링(Emoji Smuggling)" 공격 원리, 대안 공격, 방어 방법을 설명하는 메인 문서.
- `GEMINI.md`: Gemini-CLI 참고용 개발 가이드 (현재 이 문서).
- `emoji_smuggler.py`: 공격 페이로드를 생성하고 원리를 시연하는 Python 스크립트.

## 3. 프로젝트 상세

### 3.1. "이모지 스머글링(Emoji Smuggling)" 원리 분석

- 핵심 로직: 이 기법은 문자가 아닌 바이트(bytes)를 기호에 매핑하는 것이 핵심이다.
  - 1단계 (바이트 변환): 비밀 메시지(예: "Hi 휴")를 원시 UTF-8 바이트 시퀀스로 변환한다. (예: `[72, 105, 32, 237, 156, 180]`)
  - 2단계 (비밀 알파벳): 256개의 특정 유니코드 문자(주로 보이지 않는 "Variation Selector" `U+FE00`–`U+FE0F` 16개 문자, `U+E0100`–`U+E01EF` 240개 문자)를 "비밀 알파벳"으로 정의한다.
  - 3단계 (매핑): 0부터 255까지의 각 바이트 값을 256개의 "비밀" 문자 중 하나에 일대일로 할당한다.
  - 4단계 (문자열 생성): 최종 메시지는 [기본 이모지](예: `😎`) + (72에 해당하는 비밀 문자) + (105에 해당하는 비밀 문자)... 순서로 구성된다.

### 3.2. 파이썬 스크립트 포팅

- 기능 1 (인코딩): 입력받은 문자열(악의적 프롬프트)을 UTF-8 바이트로 변환한 뒤, 이를 "비밀 알파벳" 유니코드 시퀀스로 매핑하여 "스머글링"된 텍스트를 생성하는 함수를 구현한다.
- 기능 2 (디코딩): "스머글링"된 텍스트를 다시 원본 프롬프트로 복원하는 디코딩 함수를 구현한다 (검증용).
- 주석: 각 단계(UTF-8 인코딩, 바이트-심볼 매핑)를 명확히 설명하는 상세한 주석을 작성한다.

### 3.3. 취약점 및 방어 전략 분석

- 취약점 분석: 이 공격이 성공하는 근본적인 이유를 심층 분석한다.
- 대안 공격 제안: 이모지와 폭 없는 문자가 아니더라도, 동일한 '바이트-심볼 매핑' 등 원리를 사용할 수 있는 다른 공격 방법을 제안하며, "이모지 스머글링(Emoji Smuggling)" 공격이 시사하는 언어모델의 근본적인 취약점을 지적한다.
- 방어 기법 제안: 원본 공격 및 동일 원리의 대안 공격을 모두 차단할 수 있는 방어 전략을 제안한다.

## 4. 어시스턴트의 역할

- 정보 검색 및 요약: "이모지 스머글링(Emoji Smuggling)" 공격의 원본 PoC(JS/TS), 관련 블로그 포스트, 기술 문서를 사용자와 함께 살펴보며, 사용자와 함께 도출해낸 인사이트에 따라 핵심 내용을 요약하여 마크다운 기술 문서를 작성한다. 기술 문서는 **한국어**를 우선 작성한 뒤, 각 한국어 문장 밑에 **영어 번역** 문장을 작성하는 것으로 한다.
- 코드 생성 및 검증: 공격 및 방어 파이썬 코드 스니펫들을 단계별로 생성한다. 특히 UTF-8 바이트 처리, 유니코드 매핑 테이블, 문자열 접합 등 정확한 사용법을 제시하고 실행 가능한 코드를 제공한다. 모든 파이썬 코드 스니펫들은 풍부한 **한국어** 주석을 포함해야 한다.
- 파일 관리: 사용자의 지시에 따라 깃 레포지토리에 각 파일의 콘텐츠를 생성 및 업데이트한다.
- 질의응답: 공격의 기술적 세부 사항, 토큰화 불일치 문제, 파이썬 코드 스니펫 구현 시 발생하는 문제 등에 대해 심층적인 답변을 제공한다.
- 전략 제안: 대안적 공격 방법론과 효과적인 방어 전략에 대해 전문적인 아이디어를 제안한다.